---
trigger: manual
description: Руководство по настройке новых проектов с интеграцией Vercel и Supabase
---

# Рабочий процесс: Интеграция Vercel + Supabase

Это руководство обеспечивает бесшовную настройку, при которой ваша база данных (Supabase) и деплой фронтенда (Vercel) идеально синхронизированы.

## Этап 1: Настройка Supabase (Бэкенд)

1.  **Создание проекта:**
    *   Перейдите на [database.new](https://database.new) (дашборд Supabase).
    *   Нажмите **"New Project"**.
    *   Выберите вашу Организацию.
    *   **Name (Имя):** Должно совпадать с именем вашего репозитория GitHub (например, `saas-crm-dashboard`).
    *   **Password (Пароль):** Сгенерируйте надежный пароль и **СОХРАНИТЕ ЕГО** в менеджере паролей немедленно.
    *   **Region (Регион):** Выберите регион, близкий к вашим пользователям (например, `Frankfurt` для ЕС или `East US` для США).
    *   Нажмите **"Create new project"**.

2.  **Ожидание создания:**
    *   Это занимает ~1-2 минуты. Пока ждете, переходите к Этапу 2.

## Этап 2: Настройка Vercel (Фронтенд)

1.  **Импорт репозитория:**
    *   Перейдите на [vercel.com/new](https://vercel.com/new).
    *   Выберите ваш репозиторий GitHub (`SaaS-CRM-Dashboard`).
    *   **Framework Preset:** Next.js (обычно определяется автоматически).
    *   **Root Directory:** `./` (по умолчанию).

2.  **Переменные окружения (Начало):**
    *   *Пока пропустите добавление переменных.* Мы используем автоматическую интеграцию для их синхронизации.
    *   Нажмите **"Deploy"**.
    *   *Примечание:* Сборка может упасть, если приложение требует ключи при билде. Это нормально на данном этапе.

## Этап 3: Автоматическая синхронизация (Магия)

Вместо ручного копирования ключей используйте нативную интеграцию.

1.  **Перейдите в дашборд Supabase:**
    *   Откройте ваш проект.
    *   В левом меню убедитесь, что проект в статусе "Active".

2.  **Подключение к Vercel:**
    *   Перейдите в **Project Settings** (иконка шестеренки) -> **Integrations**.
    *   Найдите **Vercel** и нажмите **"Install"** или **"Connect"**.
    *   Выберите ваш Vercel Scope (Личный или Командный).
    *   Выберите **Vercel Project**, который вы создали на Этапе 2 (`saas-crm-dashboard`).

3.  **Выбор переменных для синхронизации:**
    *   Supabase спросит, какие ключи отправить. Выберите:
        *   `NEXT_PUBLIC_SUPABASE_URL`
        *   `NEXT_PUBLIC_SUPABASE_ANON_KEY`
        *   `SUPABASE_SERVICE_ROLE_KEY` (убедитесь, что используется только на бэкенде!)
        *   `DATABASE_URL` (для Prisma/Drizzle) (выберите режим "Connection Pool", если доступно, порт 6543)
    *   Нажмите **"Connect Project"**.

**Результат:** Supabase автоматически отправил все необходимые переменные `.env` в окружения "Development", "Preview" и "Production" вашего проекта на Vercel. Если вы когда-нибудь обновите ключи в Supabase, Vercel обновится автоматически.

## Этап 4: Валидация локальной разработки

Чтобы убедиться, что ваша локальная настройка совпадает с облаком:

1.  **Загрузка Env из Vercel:**
    В вашем терминале (корень проекта):
    ```powershell
    npm i -g vercel
    vercel link
    vercel env pull .env
    ```
    *Эта команда скачивает точные ключи из Vercel (который получил их от Supabase) в ваш локальный файл `.env`.*

2.  **Запуск Dev:**
    ```powershell
    npm run dev
    ```

## Чек-лист Senior-качества ✅

-   [ ] **Проверка билда:** Деплой на Vercel прошел успешно?
-   [ ] **Env Vars:** Проверили настройки Vercel -> Environment Variables и увидели там ключи Supabase?
-   [ ] **Types:** Если используете TypeScript, запустили `npx supabase gen types typescript --project-id <id> > types/supabase.ts`?
